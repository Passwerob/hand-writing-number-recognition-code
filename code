import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import Dataset,DataLoader
import numpy as np
import struct
import matplotlib as plt
form torchvision import transforms

class MNISTDataset(Dataset):
  def __init__(self,image_path,label_path,transforms=None)
    self.transforms=transform
    with open(image_path,'rb') as f:
      magic,num,rows,cols=struct.unpack(">IIII",f.read(16))
      self.image=np.fromfile(f,dtype=np.unit8).reshape(num,28*28)
    with open(label_path,'rb') as f:
      magic,num=struct.unpack('>II',f.read(8))
      self.labels=np.fromfile(f,dtype=np.uint8)

  def __len__(self):
    return  len(self.labels)

  def __getitem__(self,idx):
    image=self.image[idx]
    label=self.label[idx]

